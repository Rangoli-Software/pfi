<script type="text/javascript">
function inches2cm (x) {
    return (Math.round(10 * 2.54 * x) / 10).toFixed(0);
}

function cm2inches (x) {
    return (Math.round(10 * x / 2.54) / 10).toFixed(0);
}

function identity (x) {
    return x;
}

var TSHIRT_SKU = "AWTSHT1604Je";

var sizes = ["S", "M", "L", "XL", "XXL"];
var dimensionNames = ["Shoulder", "Chest", "Length"];

var dimensionsInches = {
        S: [
            [14, 15],
            [38, 39],
            [26, 27]
        ],
        M: [
            [15, 16],
            [40, 41],
            [27, 28]
        ],
        L: [
            [16, 17],
            [42, 43],
            [28, 29]
        ],
        XL: [
            [17, 18],
            [43, 44],
            [29, 30]
        ],
        XXL: [
            [18, 19],
            [45, 46],
            [30, 31]
        ]
    };

var dimensionWidths = [29, 35, 29];

function createSizingTable(units) {
        var fn = units == "in" ? identity : inches2cm;
        var rem = 100;
        for (var i = 0; i < dimensionWidths.length; i++) {
            rem -= dimensionWidths[i];
        }
        var table = '<table class="table table-bordered table-sm table-hover mb-0 text-center"><caption><strong>Measurements (in ' + (units == "in" ? "inches" :  "cm") + ')</strong></caption><thead>\
                <tr><td class="text-left" width="' + rem + '%"><strong>Size</strong></td>';
        for (var i = 0; i < dimensionWidths.length; i++) {
            table += '<td width="' + dimensionWidths[i] + '%"><strong>' + dimensionNames[i] + '</strong></td>';
        }
        table += '</tr></thead><tbody>';
        for (var i = 0; i < sizes.length; i++) {
            var size = sizes[i];
            var dims = dimensionsInches[size];
            table += '<tr><td class="text-left">' + size + '</td>';
            for (var j = 0; j < dimensionNames.length; j++) {
                subdim = dims[j];
                table += '<td>' + fn(subdim[0]) + " - " + fn(subdim[1]) + '</td>';
            }
            table += '</tr>'
        }
        table += '</tbody></table>';
        return table;
    }
    
function onUnitChange() {
    $('#SizeTable').empty();
    var selRadio = $("input[name='SizeChartUnits']:checked");
    var units = selRadio.val();
    var table = createSizingTable(units);
    $(table).appendTo('#SizeTable');
}

var sizingData = {
    S: [27.0, 30.0],
    M: [29.0, 31.5],
    L: [30.5, 33.0],
    XL: [32.0, 35.0],
    XXL: [34.0, 37.0]
}

function worksWithSize(width, size) {
    var range = sizingData[ size ];
    return (range[0] <= width && width <= range[1]);
}

function createPanelsObject(listData, product) {
    return {
        base: listData,
        product: product,
        getNumPanels: function() {
            return this.base.length;
        },
        getId: function(i) {
            return this.base[i][0];
        },
        getDescriptor: function(i) {
            return createTShirtDescriptor(this.base[i]);
        },
        getItem: function(i, size) {
            var desc = this.getDescriptor(i);
            return createItem(product, product.inrPrice, size, desc.fabricColour, 1, desc.number, desc.imageURL, true);
        },
        filterUnsoldPanels: function () {
            var nList = [];
            for(var i = 0; i <= this.base.length - 1; i++) {
                if (this.base[ i ][ 5 ] === "") {
                    nList.push(this.base[ i ]);
                }
            }
            return createPanelsObject(nList, this.product);
        },
        filterOnColour: function(color) {
            var nList = [];
            for(var i = 0; i <= this.base.length - 1; i++) {
                if (this.base[ i ][ 2 ] === color) {
                    nList.push(this.base[ i ]);
                }
            }
            return createPanelsObject(nList, this.product);
        },
        filterOnSize: function(size) {
            var nList = [];
            for(var i = 0; i <= this.base.length - 1; i++) {
                var arr = this.base[ i ];
                var recSize = arr[ 7 ];
                if ( recSize == '' ) {
                    var width = parseFloat(arr[ 4 ]);
                    if (worksWithSize(width, size)) {
                        nList.push(arr);
                    }
                } else {
                    if ( recSize == size ) {
                        nList.push(arr);
                    }
                }
            }
            return createPanelsObject(nList, this.product);
        }
    }
}

function createTShirtRenderer(tshirtDesc, prodDesc, shop, options) {
        return {
            tshirtDesc: tshirtDesc,
            prodDesc: prodDesc,
            shop: shop,
            options: options,
            getDescription: function() {
                return "# " + this.tshirtDesc.number + '<br>' +
                    this.tshirtDesc.width + " cm. x " + this.tshirtDesc.height + " cm.";
            },
            getFGColor: function() {
                return this.tshirtDesc.fabricColour === "Black" ? "white" : "black";
            },
            getBGColor: function() {
                return this.tshirtDesc.fabricColour === "Black" ? "black" : "white";
            },
            getButtonID: function() {
                return createButtonID(this.tshirtDesc.number);
            },
            getSizeCheckID: function() {
                return createSizeCheckID(this.tshirtDesc.number);
            },
            createAddToCartButton: function() {
                var id = this.getButtonID();
                return '<button id="' + id + '" class="btn btn-warning btn-sm" type="button"><span class="fa fa-cart-plus"></span> Add to Cart</button>';
            },
            getDefaultSize: function() {
                return this.tshirtDesc.size === '' ? 'M' : this.tshirtDesc.size;
            },
            createSizeRadio: function(sz) {
                if (worksWithSize(this.tshirtDesc.width, sz)) {
                    var fgcolor = this.getFGColor();
                    var ret = '<div class="form-check form-check-inline">\
<input class="form-check-input" type="radio" name="size' + this.tshirtDesc.number + '" value="' +
                        sz + '" id="ir' + sz + '"' +
                        ((this.getDefaultSize() === sz) ? ' checked' : '') +
                        '>\
<label class="form-check-label" for="ir' +
                        sz + '" style="color: ' + fgcolor + '">' + sz + '</label>\
    </div>';
                    return ret;
                }
                return '';
            },
            createRadios: function() {
                return this.createSizeRadio("S") +
                    this.createSizeRadio("M") +
                    this.createSizeRadio("L") +
                    this.createSizeRadio("XL") +
                    this.createSizeRadio("XXL");
            },
            createSizeOptions: function() {
                return '<p>Select ' + this.tshirtDesc.fabricColour + ' T-Shirt Size</p><p>' +
                    this.createRadios() +
                    '</p>';
            },
            createSingleSize: function() {
                return "<p>1 Panel on<br>'" + this.options.size + "' size " + this.tshirtDesc.fabricColour + " T-Shirt</p>";
            },
            createDescriptionPanel: function() {
                return '<div class="col-md-7"><div class="row"><div class="col-10 offset-1">\
<figure>\
<img src="' + this.tshirtDesc.imageURL + '" class="img-fluid center-block">\
    </figure>\
<p style="color: ' + this.getFGColor() + '; text-align: center">FabricArt Panel ' + this.getDescription() + '</p>\
    </div></div></div>';
            },
            createItemPanel: function() {
                return '<div class="form-group" id="' + this.getSizeCheckID() + '">' +
                    (this.options.size != null ?
                        this.createSingleSize() :
                        this.createSizeOptions()) +
                    '</div><p>' + this.createAddToCartButton() + '</p>';
            },
            createPurchasePanel: function() {
                var radios = this.createRadios();
                return '<div class="col-md-5 align-self-center"><div class="row"><div class="col-10 offset-1 text-center">\
<p style="font-size: 150%">' +
                    this.shop.getPriceHTML(this.prodDesc) + '</p>' + (this.shop.isIndian() ? '<p style="font-size: 75%">free standard shipping within India</p>' : '') +
                    this.createItemPanel() +
                    '</div></div></div>';
            },
            createSalePanel: function() {
                return '<div class="item sc-panel" style="background-color: ' +
                    this.getBGColor() + ';color: ' + this.getFGColor() + ';">\
<div class="row">' +
                    this.createDescriptionPanel() +
                    this.createPurchasePanel() +
                    '</div></div>';
            }
        }
    }

    function createButtonID(num) {
        return "btn" + num;
    }

    function createSizeCheckID(num) {
        return "ir" + num;
    }

    function createSep() {
        return '<div style="border-bottom:1px solid grey;"></div>';
    }

    function createPanelsRenderer(shop, options, panels) {
        return {
            shop: shop,
            options: options,
            panels: panels,
            createRowPanel: function(i) {
                var tDesc = this.panels.getDescriptor(i);
                var prodDesc = this.panels.product;
                var renderer = createTShirtRenderer(tDesc, prodDesc, this.shop, this.options);
                return renderer.createSalePanel();
            },
            createAllPanels: function() {
                var ret = "";
                if (this.options.size != null) {
                    ret += '<div class="invisible" id="selectedSize">' + this.options.size + '</div>';
                }
                for (var i = 0; i <= this.panels.base.length - 1; i++) {
                    ret += this.createRowPanel(i);
                    if (i < this.panels.base.length - 1) {
                        ret += createSep();
                    }
                    var id = this.panels.getId(i);
                }
                return ret;
            }
        };
    }

    function createPageComponent(tlpc) {
        return {
            allCartC: null,
            visiblePanels: null,
            init: function(shop) {
                this.allCartC = createAllCartComponents(shop, this);
            },
            getSizeField: function(i) {
                var num = this.visiblePanels.getDescriptor(i).number;
                var scid = "#" + createSizeCheckID(num) + " input[type='radio']:checked";
                var sel = $(scid);
                if (sel.length != 0) {
                    return sel.attr('value');
                } else if ($('#SizeSelect').length != 0) {
                    return $('#SizeSelect').val();
                } else {
                    return null;
                }
            },
            createPanelItem: function(i, size) {
                var panel = this.visiblePanels.getDescriptor(i);
                var product = this.visiblePanels.product;
                return createItem(product, product.inrPrice, size, panel.fabricColour, 1, panel.number, panel.imageURL, true);
            },
            addToCart: function(i) {
                var size = this.getSizeField(i);
                if (size === null) {
                    return false;
                }
                var item = this.createPanelItem(i, size);
                return this.allCartC.addToCart(item);
            },
            registerATCListeners: function() {
                if (this.visiblePanels === null) {
                    return;
                }
                var that = this;
                for (var i = 0; i < this.visiblePanels.getNumPanels(); i++) {
                    var eltBnd = $("#" + createButtonID(this.visiblePanels.getId(i)));
                    let idx = i;
                    eltBnd.on('click', function() {
                        that.addToCart(idx);
                    });
                }
            },
            unregisterATCListeners: function() {
                if (this.visiblePanels === null) {
                    return;
                }
                var that = this;
                for (var i = 0; i < this.visiblePanels.getNumPanels(); i++) {
                    var eltBnd = $("#" + createButtonID(that.visiblePanels.getId(i)));
                    eltBnd.off('click');
                }
            },
            getSelectedColour: function() {
                var selColour = $('#ColourSelect');
                return selColour.find(':selected').text();
            },
            getSelectedSize: function() {
                var selRadio = $("input[name='sizeRadio']:checked");
                return selRadio.val();
            },
            setShop: function(shop) {
                this.allCartC.setShop(shop);
            },
            onSelectionChange() {
                this.unregisterATCListeners();
                $('#fabricartpanel-list .btn').off('click');
                $('#fabricartpanel-list').empty();
                var valColour = this.getSelectedColour();
                var valSize = this.getSelectedSize();

                this.visiblePanels = this.getFilteredPanels(valColour, valSize);

                var options = (valSize === "All") ? {} : {
                    size: valSize
                };
                var listRenderer = createPanelsRenderer(this.allCartC.shop, options, this.visiblePanels);
                var listHTML = listRenderer.createAllPanels();
                $(listHTML).appendTo('#fabricartpanel-list');
                this.registerATCListeners();
            },
            getFilteredPanels(valColour, valSize) {
                var product = getProductCatalog().getProduct(TSHIRT_SKU);
                var panels = createPanelsObject(colListData, product);

                var unsold = panels.filterUnsoldPanels();
                var sizedPanels = !(valSize == "All") ? unsold.filterOnSize(valSize) : unsold;
                return !(valColour === "All") ? sizedPanels.filterOnColour(valColour) : sizedPanels;
            }
        }
    }

    var pageComponent;

    function initPageComponent() {
        let searchParams = new URLSearchParams(window.location.search);
        var cur = searchParams.has('cur') ? searchParams.get('cur') : null;
        let shop = loadShop(cur);
        pageComponent = createPageComponent(shop);
        pageComponent.init(shop);
    }

    function onDocumentReady() {
        initPageComponent();
        pageComponent.onSelectionChange();
    }

    function onSelectionChange() {
        pageComponent.onSelectionChange();
    }

    function onCurrencyChange(shop) {
        pageComponent.setShop(shop);
    }

</script>
<h1>
    <%- title %>
</h1>
<div class="item">
    <figure>
        <img src="/fabricart/TShirtColl.jpg" class="figure-img img-fluid center-block" />
    </figure>
    <p>A piece of wearable art! Our T-Shirt with a <strong>numbered</strong> FabricArt chest panel makes the perfect gift for that unique individual. I create each panel individually as a collage composed of textile strips.</p>
</div>
<div class="item">
    <figure>
        <div id="carousel-panel-process" class="carousel slide" data-ride="carousel" data-interval="2500">
            <ol class="carousel-indicators">
                <li data-target="#carousel-panel-process" data-slide-to="0" class="active"></li>
                <li data-target="#carousel-panel-process" data-slide-to="1"></li>
                <li data-target="#carousel-panel-process" data-slide-to="2"></li>
            </ol>
            <div class="carousel-inner">
                <div class="carousel-item active">
                    <img class="d-block w-100" src="/fabricart/Collage02.jpg" alt="First slide">
                </div>
                <div class="carousel-item">
                    <img class="d-block w-100" src="/fabricart/Collage03.jpg" alt="Second slide">
                </div>
                <div class="carousel-item">
                    <img class="d-block w-100" src="/fabricart/Collage01.jpg" alt="Third slide">
                </div>
            </div>
            <a class="carousel-control-prev" href="#carousel-panel-process" role="button" data-slide="prev">
                <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                <span class="sr-only">Previous</span>
            </a>
            <a class="carousel-control-next" href="#carousel-panel-process" role="button" data-slide="next">
                <span class="carousel-control-next-icon" aria-hidden="true"></span>
                <span class="sr-only">Next</span>
            </a>
        </div>
    </figure>
        <p>The fabric strips come from my <a href="/journey/treasuretrove.html">treasure-trove</a> of vintage Tangail sari borders (hand-woven in the finest cotton, silk and metal-zari).</p>
</div>
<div class="row">
    <div class="col-md-6">
        <figure>
            <div id="carousel-t-shirt-mood" class="carousel slide" data-ride="carousel" data-interval="2500">
                <ol class="carousel-indicators">
                    <li data-target="#carousel-t-shirt-mood" data-slide-to="0" class="active"></li>
                    <li data-target="#carousel-t-shirt-mood" data-slide-to="1"></li>
                </ol>
                <div class="carousel-inner">
                    <div class="carousel-item active">
                        <img class="d-block w-100" src="/fabricart/ManWhiteS.jpg" alt="First slide">
                    </div>
                    <div class="carousel-item">
                        <img class="d-block w-100" src="/fabricart/GirlBlackS.jpg" alt="Second slide">
                    </div>
                </div>
                <a class="carousel-control-prev" href="#carousel-t-shirt-mood" role="button" data-slide="prev">
                    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                    <span class="sr-only">Previous</span>
                </a>
                <a class="carousel-control-next" href="#carousel-t-shirt-mood" role="button" data-slide="next">
                    <span class="carousel-control-next-icon" aria-hidden="true"></span>
                    <span class="sr-only">Next</span>
                </a>
            </div>
        </figure>
            <p>Each panel is a labour of love. You can read more about the process <a href="/tangailcollage.html">here</a></p>
    </div>
    <div class="col-md-6">
        <figure>
            <img src="/fabricart/InBagSq.jpg" class="img-fluid center-block" />
        </figure>
            <p>Along with your T-shirt, you will receive one of our gift bags: a delicate transparent cotton organza envelope with a mother-of-pearl button closure, making it a perfect gift item!
            </p>
    </div>
</div>
<div class="row">
    <div class="col-md-6 offset-md-3">
    </div>
</div>
<h3>Buy Now</h3>
    <p>These are the panels that are currrently available. The entire series, including the panels that have already been collected, can be viewed <a href="/tangailcollage.html#fullseries">here</a>. As new panels are created, they will be numbered and listed here for sale.</p>
<p>Our unisex T-shirts are crew-neck and regular-fit, made of soft bio-washed, 100% cotton (160 gsm weight).
</p>
<p> Select a T-Shirt size (see the size chart below for dimensions) and colour to find what works for you. When you order your one-of-a-kind numbered collage, it will be stitched on to a T-shirt and shipped to you.
</p>
<form>
    <h3>The Panels</h3>
    <div class="row align-items-center">
        <div class="col-6 text-center">
            <div class="form-group">
                <label for="SizeSelect">Size: </label>
                <span id="SizeSelect" class="mb-2">
                <div class="custom-control custom-control-inline custom-control-size mb-2">
                    <input type="radio" class="custom-control-input" name="sizeRadio" id="sizeRadioOne" value="S" onclick="onSelectionChange()">
                    <label class="custom-control-label" for="sizeRadioOne">S</label>
                </div>
                <div class="custom-control custom-control-inline custom-control-size mb-2">
                    <input type="radio" class="custom-control-input" name="sizeRadio" id="sizeRadioTwo" value="M" checked="checked" onclick="onSelectionChange()">
                    <label class="custom-control-label" for="sizeRadioTwo">M</label>
                </div>
                <div class="custom-control custom-control-inline custom-control-size mb-2">
                    <input type="radio" class="custom-control-input" name="sizeRadio" id="sizeRadioThree" value="L" onclick="onSelectionChange()">
                    <label class="custom-control-label" for="sizeRadioThree">L</label>
                </div>
                <div class="custom-control custom-control-inline custom-control-size mb-2">
                    <input type="radio" class="custom-control-input" name="sizeRadio" id="sizeRadio4" value="XL" onclick="onSelectionChange()">
                    <label class="custom-control-label" for="sizeRadio4">XL</label>
                </div>
                <div class="custom-control custom-control-inline custom-control-size mb-2">
                    <input type="radio" class="custom-control-input" name="sizeRadio" id="sizeRadio5" value="XXL" onclick="onSelectionChange()">
                    <label class="custom-control-label" for="sizeRadio5">XXL</label>
                </div>
                </span>
            </div>
        </div>
        <div class="col-6 text-center">
            <div class="form-group">
                <label for="ColourSelect">Color: </label>
                <select id="ColourSelect" class="custom-select" style="width: auto;" onchange="onSelectionChange()">
                    <option>All</option>
                    <option selected="selected">Black</option>
                    <option>White</option>
                </select>
            </div>
        </div>
    </div>
</form>
<form action="/shop/checkout.html" method="get">
    <div id="fabricartpanel-list" class="item">
        <script>
            $(document).ready(onDocumentReady);
        </script>
    </div>
</form>
<section class="pt-7"><div class="container"><div class="row"><div class="col-12">
    <div class="nav nav-tabs nav-overflow justify-content-start justify-content-md-center border-bottom">
        <a class="nav-link active" data-toggle="tab" href="#sizing">
            Sizing
        </a>
        <a class="nav-link" data-toggle="tab" href="#care">
            Care
        </a>
        <a class="nav-link" data-toggle="tab" href="#shipping">
            Availability
        </a>
    </div>
    <div class="tab-content">

    
        <div class="tab-pane fade show active" id="sizing"><div class="item">
            <div class="row align-items-center">
                <div class="col-md-4 text-center py-5">
                    <img src="/fabricart/TSizing1.jpg" class="img-fluid center-block"/>
                </div>
                <div class="col-md-8 text-center py-5">
                    <div class="btn-group btn-group-toggle ml-auto py-5" data-toggle="buttons">
                    <label class="btn btn-xxs btn-circle btn-outline-dark font-size-xxxs rounded-0 active">
                        <input type="radio" name="SizeChartUnits" value="in" onclick="onUnitChange()" checked>IN
                    </label>
                    <label class="btn btn-xxs btn-circle btn-outline-dark font-size-xxxs rounded-0 ml-2">
                        <input type="radio" name="SizeChartUnits" value="cm" onclick="onUnitChange()">CM
                    </label>
                    </div>

                    <div id="SizeTable">
                    <script>
                        document.write(createSizingTable("in"));
                    </script>
                    </div>
<!--        <table class="table table-striped table-responsive text-center">
            <caption><strong>Measurements (in cm.)</strong></caption>
            <script>
                document.write(createSizingTable(function(x) {
                    return inches2cm(x);
                }))
            </script>
        </table>-->
                </div>
            </div>

        </div></div>

        <div class="tab-pane fade" id="care"><div class="item py-5">

<p>Each border in every panel has been individually tested for colour-fastness and colour-fixed in some cases, so there will be no colour-bleeding with normal washing.</p>
<p>For wash-care and other pre-purchase information take a look at our <a href="shopfaq.html">Shop FAQ</a>.</p>

        </div></div>

        <div class="tab-pane fade" id="shipping"><div class="item py-5">

<p>Since our garments are on sale in several physical locations in addition to the website, there is a small chance that the one-of-a-kind item that you have selected has already been sold. In this case, we will let you select another item of the same kind, or refund your purchase price, as you prefer.</p>

        </div></div>

    </div>
</div></div></div></section>
<section>
<h3>Corporate Gifts</h3>
<p>These panels make fantastic corporate gifts. Please email us if you would like to order a batch of panels for corporate gifting to team members or executives. If you like, we can also attach them to your corporate branded t-shirts.</p>
</section>
<div class="item">
    <p><strong>Models: Shajin Kalathingal, Gulshan Gupta, Kartik Samuel Isaac. Photography by Mathilde Hauser</strong></p>
</div>
